<TITLE>Z-Mail for Windows FAQ</TITLE>
<HEAD><H1><A href=""><IMG align=middle SRC="../images/zncd-color.gif"></A>
Z-Mail for Windows 3.21 - 4.0</H1>
<H3>Frequently Asked Questions</H3>
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<hr><pre>
Index:

<dl><dd><a href="#I">I.</a> Internet Mail Basics
   <dl><dd><a href="#IA">A.</a> What do I need to send and receive email?
   <dd><a href="#IB">B.</a> What is a Mail User Agent?
   <dd><a href="#IC">C.</a> What is MIME?</dl>
<dd><a href="#II">II.</a> Z-Mail for Windows
   <dl><dd><a href="#IIA">A.</a> What is the most current version?
   <dd><a href="#IIB">B.</a> What system requirements must I fullfill?
      <dl><dd><a href="#IIB1">1.</a> What do I need to use Z-Mail from a LAN?
      <dd><a href="#IIB2">2.</a> What do I need to use Z-Mail over a serial line?</dl>
   <dd><a href="#IIC">C.</a> What is win32s?
   <dd><a href="#IID">D.</a> What versions of Microsoft Windows are supported by Z-Mail?
   <dd><a href="#IIE">E.</a> Why is Z-Mail 4.0 a 16-bit program?
   <dd><a href="#IIF">F.</a> Where can I find viewers for MIME attachments?</dl>
<dd><a href="#III">III.</a> Installation of Z-Mail for Windows
   <dl><dd><a href="#IIIA">A.</a> What do I need to do to insure a "clean install?"
   <dd><a href="#IIIB">B.</a> What if I already had a copy of Z-Mail installed?
   <dd><a href="#IIIC">C.</a> I don't know what machines and ports POP-3 and SMTP
   services are installed on.  How do I find out?
   <dd><a href="#IIID">D.</a> What is Z-POP and how do I find out if I have it?
   <dd><a href="#IIIE">E.</a> Why does Z-Mail complain about my License Key?
   <dd><a href="#IIIF">F.</a> Z-Mail 3.21 informed me that I already had win32s,
   so I didn't install the copy you provided.
      <dl><dd><a href="#IIIF1">1.</a> When I run Z-Mail it crashes instantly!  What could it be?
      <dd><a href="#IIIF2">2.</a> What is a GROWSTUB error in my POINTER.DLL?</dl>
   <dd><a href="#IIIG">G.</a> Do I want my users to be able to save their passwords?
   <dd><a href="#IIIH">H.</a> What is my PC's hostname?
   <dd><a href="#IIIi">I.</a> How do I install Z-Mail on a network?
      <dl><dd><a href="#IIIi1">1.</a> How do I install to a shared drive?
      <dd><a href="#IIIi2">2.</a> What is a "NETCOPY" install?</dl></dl>
<dd><a href="#IV">IV.</a> User Maintence
   <dl><dd><a href="#IVA">A.</a> How do I add / remove users with Z-Mail 3.21?
   <dd><a href="#IVB">B.</a> How do I add / remove users with Z-Mail 4.0?
   <dd><a href="#IVC">C.</a> How do I change a user's POP-3 server, or SMTP host?</dl>
<dd><a href="#V">V.</a> Z-Mail Troubleshooting
   <dl><dd><a href="#VA">A.</a> Network Problems
      <dl><dd><a href="#VA1">1.</a> What is a "Cannot connect to network - WINSOCK not found" error?
      <dd><a href="#VA2">2.</a> Where can I find a WINSOCK-compatible TCP/IP network interface?
      <dd><a href="#VA3">3.</a> In UUPC mode Z-Mail complains about WINSOCK.  How can I fix that?
      <dd><a href="#VA4">4.</a> What is a dummy WINSOCK.DLL and where do I find one?
      <dd><a href="#VA5">5.</a> Will Z-Mail work with WINSOCK 2.0?
      <dd><a href="#VA6">6.</a> How can I debug my WINSOCK TCP/IP stack?</dl>
   <dd><a href="#VB">B.</a> Receiving Email
      <dl><dd><a href="#VB1">1.</a> What POP-3 servers do you recommend?
      <dd><a href="#VB2">2.</a> What is Mailbox Synchronization?
      <dd><a href="#VB3">3.</a> Do you support IMAP?
      <dd><a href="#VB4">4.</a> What alternatives to POP-3 do you support (NFS)?
      <dd><a href="#VB5">5.</a> How do I set up a vacation filter?
      <dd><a href="#VB6">6.</a> Why does Z-Mail download duplicates of all my email?
      <dd><a href="#VB7">7.</a> What is a pop_dropcopy ERROR?
      <dd><a href="#VB8">8.</a> What is the init_check option for POP-3?
      <dd><a href="#VB9">9.</a> Why are my "Quick Check" synch scenerios greyed out?
     <dd><a href="#VB10">10.</a> Why does some of my new mail show up out of order after a synch?
     <dd><a href="#VB11">11.</a> What is a "pop_stat" error, and how do I get around it?
     <dd><a href="#VB12">12.</a> What is a "ZHB2" error?</dl>
   <dd><a href="#VC">C.</a> Sending Email
      <dl><dd><a href="#VC1">1.</a> What is a "SMTP error - connection refused"?
      <dd><a href="#VC2">2.</a> How do I save a copy of my outgoing email?
      <dd><a href="#VC3">3.</a> Do you support UUCP (UUPC)?
      <dd><a href="#VC4">4.</a> Do you support PGP (Pretty Good Privacy) for email encryption?
      <dd><a href="#VC5">5.</a> How do I avoid loosing email with bad addresses?</dl></dl>
   <dd><a href="#VD">D.</a> Filtering Email
      <dl><dd><a href="#VD1">1.</a> How come my autoreply only works on the first filtered message?</dl>
<dd><a href="#VI">VI.</a> Graphical User Interface
   <dl><dd><a href="#VIA">A.</a> Where did all my Z-Mail 3.21 buttons go when I upgraded?
   <dd><a href="#VIB">B.</a> Where did all my Z-Mail 3.21 toolbar items go when I upgraded?
   <dd><a href="#VIC">C.</a> How do I use one of my own icons or bitmaps to the toolbar?]
   <dd><a href="#VID">D.</a> Where can I find a listing of Z-Mail for Windows toolbar icons?
   <dd><a href="#VIE">E.</a> How do I "pinup" my MDI Child windows Z-Mail 4.0?
   <dd><a href="#VIF">F.</a> I have a laptop.  How can I set Z-Mail 4.0 to 640x480?
   <dd><a href="#VIG">G.</a> How do I paste addresses into a Z-Mail 4.0 compose "To:" field?
   <dd><a href="#VIH">H.</a> How do I start Z-Mail minimized?
   <dd><a href="#VIi">I.</a> How do I bypass the Z-Mail login dialog?
   <dd><a href="#VIJ">J.</a> How do I save an alias after changing it?
   <dd><a href="#VIK">K.</a> Why doesn't Z-Mail remember my printer setup?
   <dd><a href="#VIL">L.</a> Can I use the Address Browser offline?
   <dd><a href="#VIM">M.</a> How can I view uuencoded inclusions in Z-Mail 3.2?</dl>
<dd><a href="#VII">VII.</a> Z-Script, Filters, Functions
   <dl><dd><a href="#VIIA">A.</a> Where can I learn about Z-Script?
   <dd><a href="#VIIB">B.</a> How can I get Z-Mail to automatically run filters and open folders during startup?
   <dd><a href="#VIIC">C.</a> What other automatic "hook" functions are available?
   <dd><a href="#VIID">D.</a> What happens to my zmail.rc file when I upgrade?</dl>
<dd><a href="#VIII">VIII.</a> Other Sources of Information
  <dl><dd><a href="#VIIIA">A.</a> Where can I find additional info on Z-Mail for Windows?</dl>
</dl><hr>

<a name="I"><b>I. Internet Mail Basics</b></a>

   <a name="IA"><b>A. What do I need to send and receive email?</b></a>

Whether you are using the Internet from a University or inside a corporation
using a departmental LAN, you still need three items to send email.  The first
two components consist of a Mail User Agent (MUA), which is the client that you
use to compose and send, as well as read your email, along with the Mail
Transport Agents (MTA) which handle the delivery of your message.  The third
component is the delivery protocol, which determines how your message is
formatted and delivered.

   <a name="IB"><b>B. What is a Mail User Agent?</b></a>

The Mail User Agent (MUA) is the software you use at your desk, or on a shared
computer, to read, send, filter, and sort your email.  Z-Mail for Windows is a
MUA in that it handles everything but the actual delivery of a message to the
receipient.

   <a name="IC"><b>C. What is MIME?</b></a>

Multipurpose Internet Mail Extensions (MIME) include support for sending binary
attachments from one user to another.  They define the way a .gif image, for
example, is encoded and attached to an email message so that the receiving 
party can detach and decode the image and successfully view it.  Z-Mail 
supports MIME on all platforms, including Windows.

<a name="II"><b>II. Z-Mail for Windows</b></a>

   <a name="IIA"><b>A. What is the most current version?</b></a>

Z-Mail 3.21 has just recently been replaced by Z-Mail 4.0.00

   <a name="IIB"><b>B. What system requirements must I fullfill?</b></a>

Z-Mail 3.21:
	4MB RAM (8MB RAM recommended)
	4MB free space on your hard drive
	MS-Windows 3.1 or newer
	win32s subsystem (INCLUDED)
	VGA display
	80386DX or better CPU
	WINSOCK TCP-IP networking (LAN-based, PPP, SLIP, UUPCX)
	POP-3 and SMTP servers

Z-Mail 4.0:
	4MB RAM (8MB RAM recommended)
	4MB free space on your hard drive
	MS-Windows 3.1 or newer
	VGA display
	80386DX or better CPU
	WINSOCK TCP-IP networking (INCLUDED  - not necessary with serial)
	POP-3 and SMTP servers

      <a name="IIB1"><b>1. What do I need to use Z-Mail from a LAN?</b></a>

You will need a WINSOCK 1.1 compatible TCP/IP network interface running on the
local PC.  Z-Mail for Windows 4.0 actually ships with one, the "NCD TCP/IP
Stack", which can optionally be installed before or after setup.  If you are 
on a LAN you will also need an account on a POP-3 server (usually a UNIX or 
Windows NT box) from where you can retrieve your mail.  You will also need 
access to a similiar machine running SMTP.

      <a name="IIB2"><b>2. What do I need to use Z-Mail over a serial line?</b></a>

Z-Mail for Windows 4.0 has the ability to upload and download mail directly
over a serial line, without a TCP/IP network interface (though PPP and SLIP 
are generally recommended).  For this you will need a Hayes-compatible modem 
that supports error-correcting.  Speeds up to 28.8k with compression are 
fully supported.

You will also need an account on a POP-3 server (usually a UNIX or Windows NT 
box) from where you can retrieve your mail.  You will also need access to a 
similiar machine running SMTP.

   <a name="IIC"><b>C. What is win32s?</b></a>

Win32s is a subsystem designed by Microsoft for the Windows 3.1x and Windows
for Workgroups 3.1x 16-bit operating systems. The Win32s libraries allow
Win3.1x and WfW 3.1x users to run Win32 (32-bit) applications on their 16-bit
operating systems. Windows NT and Win95 are 32-bit operating systems with
Win32s and OLE support built into the operating system. Users of Windows NT and
Win95 should NOT install Win32s on their systems.

NOTE: Win32s is not required by Z-Mail for Windows 4.0.

   <a name="IID"><b>D. What versions of Microsoft Windows are supported by Z-Mail?</b></a>

Windows 3.1x
Windows for Workgroups 3.11
Windows NT 3.5x

   <a name="IIE"><b>E. Why is Z-Mail 4.0 a 16-bit program?</b></a>

Four good reasons:

Performance - On 16-bit versions of Windows Z-Mail 16 will outperform Z-Mail
32. Also, it gives us the ability to run with virtually no performance
penalties on 32-bitWindows versions, such as NT or '95.

Support - A significant number of our support requests are related to
configuration of Win32s - driver version conflicts, high memory problems, and
so on.

Stability - Win32s running on Windows 3.1x is subject to a wide variety of
system configuration problems, making it harder to keep running as users add
software, hardware, and so on.

Broader supported platform range - A win16 version allows us to not only run
on standard windows hardware, but also on things like SoftWindows, Wabi, OS/2,
PowerPC NT (non-native) and so on, all of which have problems (to varying
degrees) with 32-bit windows applications.

   <a name="IIF"><b>F. Where can I find viewers for MIME attachments?</b></a>
</pre><TABLE BORDER>
<TR>
<TH>MIME Type</TH>
<TH>External Viewer</TH>
<TH>File Type</TH>
<TH>Extension</TH>
</TR>

<TR>
<TD ALIGN=CENTER>application/postscript</TD>
<TD ALIGN=CENTER>Ghostview </TD>
<TD ALIGN=CENTER>Postscript file</TD>
<TD ALIGN=CENTER> .ps</TD> 
</TR>

<TR>
<TD ALIGN=CENTER>video/mpeg</TD>
<TD ALIGN=CENTER>Mpegplay </TD>
<TD ALIGN=CENTER>movie file</TD>
<TD ALIGN=CENTER> .mpg </TD>
</TR>

<TR>
<TD ALIGN=CENTER>image/jpeg</TD>
<TD ALIGN=CENTER>Lview Pro</TD>
<TD ALIGN=CENTER>image file</TD>
<TD ALIGN=CENTER> .jpg </TD>
</TR> 

<TR>
<TD ALIGN=CENTER>text/plain</TD>
<TD ALIGN=CENTER>Superpad</TD>
<TD ALIGN=CENTER>text file</TD>
<TD ALIGN=CENTER> .txt </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/msword</TD>
<TD ALIGN=CENTER>MS Word Viewer</TD>
<TD ALIGN=CENTER>Word document</TD>
<TD ALIGN=CENTER> .doc </TD>
</TR>

<TR>
<TD ALIGN=CENTER>audio/wav</TD>
<TD ALIGN=CENTER>Windows Mplayer.exe</TD>
<TD ALIGN=CENTER>audio file</TD>
<TD ALIGN=CENTER> .wav </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/Zip</TD>
<TD ALIGN=CENTER>PKWare Zip</TD>
<TD ALIGN=CENTER>Zip file</TD>
<TD ALIGN=CENTER> .zip </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/WordPerfect5.1</TD>
<TD ALIGN=CENTER>Wordperfect 5.1</TD>
<TD ALIGN=CENTER>Wordperfect 5.1 Document</TD>
<TD ALIGN=CENTER> .wp5 </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/WordPerfect6</TD>
<TD ALIGN=CENTER>Wordperfect 6</TD>
<TD ALIGN=CENTER>Wordperfect 6 Document</TD>
<TD ALIGN=CENTER> .wp6 </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/x-Zm-Folder</TD>
<TD ALIGN=CENTER>Z-Mail</TD>
<TD ALIGN=CENTER>Mail Folder</TD>
<TD ALIGN=CENTER> .zmf </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/x-tar</TD>
<TD ALIGN=CENTER>tar.exe</TD>
<TD ALIGN=CENTER>Tar Archive</TD>
<TD ALIGN=CENTER> .tar </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/x-WinGroup</TD>
<TD ALIGN=CENTER>MS Windows</TD>
<TD ALIGN=CENTER>Windows Group</TD>
<TD ALIGN=CENTER> .grp </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/x-dBase</TD>
<TD ALIGN=CENTER>d-Base II</TD>
<TD ALIGN=CENTER>database</TD>
<TD ALIGN=CENTER> .dbf </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/x-WinWrite</TD>
<TD ALIGN=CENTER>MS Write</TD>
<TD ALIGN=CENTER>Write file</TD>
<TD ALIGN=CENTER> .wri </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/x-msExcel</TD>
<TD ALIGN=CENTER>MS Excel</TD>
<TD ALIGN=CENTER>spreadsheet</TD>
<TD ALIGN=CENTER> .xls </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/x-msrtf</TD>
<TD ALIGN=CENTER>MS Word Viewer</TD>
<TD ALIGN=CENTER>MS Rich Text</TD>
<TD ALIGN=CENTER> .rtf </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/x-msPowerpoint</TD>
<TD ALIGN=CENTER>MS Powerpoint</TD>
<TD ALIGN=CENTER>Powerpoint Document</TD>
<TD ALIGN=CENTER> .ppt </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/x-AmiPro</TD>
<TD ALIGN=CENTER>Lotus Ami Pro</TD>
<TD ALIGN=CENTER>Ami Pro Document</TD>
<TD ALIGN=CENTER> .sam </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/x-Paradox</TD>
<TD ALIGN=CENTER>Paradox 4.5</TD>
<TD ALIGN=CENTER>Paradox Database</TD>
<TD ALIGN=CENTER> .db </TD>
</TR>

<TR>
<TD ALIGN=CENTER>video/quicktime</TD>
<TD ALIGN=CENTER>Quicktime</TD>
<TD ALIGN=CENTER>Quicktime Video</TD>
<TD ALIGN=CENTER> .mov </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/pdf</TD>
<TD ALIGN=CENTER>Adobe Acrobat Reader</TD>
<TD ALIGN=CENTER>Portable Document File</TD>
<TD ALIGN=CENTER> .pdf </TD>
</TR>

<TR>
<TD ALIGN=CENTER>application/x-Presentations</TD>
<TD ALIGN=CENTER>Novell Presentations</TD>
<TD ALIGN=CENTER>pie file</TD>
<TD ALIGN=CENTER> .shw </TD>
</TR>
</TABLE><pre>

NCD does NOT endorse or support any particular viewer.  These products 
are listed here as convenience to our users.  They can be found at <a href="http://www.ncsa.uiuc.edu/SDG/Software/WinMosaic/viewers.htm">NCSA</a>, 
which is an excellent repository of viewers, though you will not need to 
modify any "Preferences" as they describe.  Z-Mail will take it's MIME viewer 
mappings from the "[extensions]" section of the C:\WINDOWS\WIN.INI file.  
Alternatively these can be set up from within the File Manager's "Associate" 
dialog.

<a name="III"><b>III. Installation of Z-Mail for Windows</b></a>

   <a name="IIIA"><b>A. What do I need to do to insure a "clean install?"</b></a>

A clean install involves removing all previous traces of Z-Mail from your 
install drive.  This would include the C:\WINDOWS\ZMAIL.INI and 
C:\WINDOWS\SYSTEM\MAPI.DLL files as well as the entire C:\ZMAIL tree.  
Z-Mail 4.0 for Windows does not require a clean upgrade, however, as it will 
utilize the defaults from earlier Z-Mail 3.2x C:\WINDOWS\ZMAIL.INI entries.

   <a name="IIIB"><b>B. What if I already had a copy of Z-Mail installed?</b></a>

Z-Mail 4.0 for Windows should be able to utilize some of the existing
information (SMTPHOST, MAILHOST, address_book, etc.) as defaults for a new
install.  With Z-Mail 3.21 a clean install is often the best idea.

   <a name="IIIC"><b>C. I don't know what machines and ports POP-3 and SMTP
      services are installed on.  How do I find out?</b></a>

If there are no system administrators (sysdaddys) around to ask, then you
should start testing TCP services by opening up a terminal connection to the
UNIX host you currently read your mail on.  After logging in, try to open up
ports 25, 110, 15213, and 15232, respectively.

Port 25: SMTP

	% telnet localhost 25
	Trying 127.0.0.1...
	Connected to localhost.
	Escape character is '^]'.
	220-localhost Sendmail 8.6.11/8.6.9 ready at Thu, 17 Aug 1995
	220 ESMTP spoken here

Port 110: POP-3 (or) Z-POP

	% telnet localhost 110
	Trying 127.0.0.1...
	Connected to localhost.
	Escape character is '^]'.
	+OK localhost POP3 3.3(19) w/IMAP2 client

Port 15213: Z-Mail Directory Services

	% telnet localhost 15213
	Trying 127.0.0.1...
	Connected to localhost.
	Escape character is '^]'.

		*** This is a special case. Please refer to the
		dirserv.d install instructions for testing
		the directory services daemon. ***

Port 15232: Z-POP

	% telnet localhost 15232
	Trying 127.0.0.1...
	Connected to localhost.
	Escape character is '^]'.
	+OK Welcome to Z-Mail ZPOP server  v.79dev (19sep94)


   <a name="IIID"><b>D. What is Z-POP and how do I find out if I have it?</b></a>

Z-Mail for Windows is designed for use in an environment where mail is
delivered to a mail server and then downloaded to a PC via POP (Post Office 
Protocol).  POP3 is a version of this protocol that has many freely available 
implementations. Z-POP is an enhanced version of POP3 that provides additional
functionality, and is available free of charge from NCD Software.

Typically Z-POP is installed on TCP service ports 15232 and 110 of your UNIX 
Mailhost.  See the above example for testing for TCP services.

   <a name="IIIE"><b>E. Why does Z-Mail complain about my License Key?</b></a>

If you entered your license key incorrectly, or it was a demo key that has
expired, you should expect to see Z-Mail complain about the license.  Your
license key must be 16 alphanumerics, with all letters in lowercase format.  
To add a new demo key in version 3.21, you must edit the "license key" 
entry in the C:\ZMAIL\LIB\SYSTEM.RC file , and the "ZMKEY" entry in the
C:\WINDOWS\ZMAIL.INI.  If you are entering a new key into Z-Mail 4.0 a nifty 
trick is to delete the text to the right of the 'LicenseInfo=' entry in the 
C:\WINDOWS\ZMAIL.INI file.  When you restart Z-Mail it will then prompt you 
for a new key!

   <a name="IIIF"><b>F. Z-Mail 3.21 informed me that I already had win32s,
      so I didn't install the copy you provided.</b></a>

This is a bug in the Z-Mail 3.2x install script.  Ignore these warnings and 
reinstall  Z-Mail 3.21 with win32s enabled.  Remember, however, that WindowsNT
and Win95 should not have Win32s installed onto them from Z-Mail 3.21.  NOTE: 
Z-Mail 4.0 is a "normal" 16-bit Windows application and is not subject to 
these problems.

      <a name="IIIF1"><b>1. When I run Z-Mail it crashes instantly!  What could it be?</b></a>

This is probably due to a faulty installation of win32s.  Try reinstalling
Z-Mail with the "Install Win32s" option enabled, then ignore any warnings while
Z-Mail 3.21 installs.

     <a name="IIIF2"><b> 2. What is a GROWSTUB error in my POINTER.DLL?</b></a>

When you start a Win32-based application using Win32s under Windows 3.1
or 3.11 or Windows for Workgroups, you may receive a general protection (GPF)
fault in POINTER.DLL caused by the Microsoft Mouse driver 9.01 GROWSTUB
component. Microsoft has corrected this problem, so all you need to do is
download HD1061.EXE and replace the POINTER.DLL file.

HD1061.EXE can be found at: ftp://ftp.microsoft.com/Softlib/MSLFILES/HD1061.EXE

   <a name="IIIG"><b>G. Do I want my users to be able to save their passwords?</b></a>

This option is enabled only during installation time.  Passwords are saved as 
encrypted text, and therefore will be difficult to decipher.  This level of 
security is left up to the local sysadmin. NOTE: if the $USER.INI file is 
located on a personal network mapped drive, then security should not even be 
an issue.

  <a name="IIIH"><b> H. What is my PC's hostname?</b></a>

Check with your sysdaddy or within the configuration options of your Winsock
TCP/IP network suite to find your PC hostname.

   <a name="IIIi"><b>I. How do I install Z-Mail on a network?</b></a>

     <a name="IIIi1"><b> 1. How do I install to a shared drive?</b></a>

--------- Z-Mail for Windows 3.21 SHARED NETWORK INSTALL ---------

For the sake of illustration, Z-Mail binaries and library files are
installed on a network server that is mapped as drive W:\ZMAIL as it appears
to the users.  The users' local directories and files are on drive C:.


NETWORK DRIVE STRUCTURE:

W:\ZMAIL		 <- ZMAIL.INI (ZMROOT=w:\zmail)
|   DIRSERV.TXT
|   RELEASE.TXT
|   ZYNC.TXT
|   ZMAIL.EXE
|
+---LIB 		 <- ZMAIL.INI (ZMLIB=w:\zmail\lib)
|   |	ATTACH.TYP
|   |	SYSTEM.RC
|   |	LOCALE.RC
|   |	VARIABLE
|   |	ZMAILMNU.RC
|   |	ZMUI.HLP
|   |
|   \---FORMS
|	    BUGS
|	    PHONE
|			    (all <private>.INI variables point to C:)
+---USER-1		 <- USER-1.INI (HOME=c:\zmail\user-1)
|	USER-1.INI	 <- USER-1.INI (USER=USER-1)
|
+---USER-2		 <- USER-2.INI (HOME=c:\zmail\user-2)
|	USER-2.INI	 <- USER-2.INI (USER=USER-2)
|
etc.


LOCAL DRIVE STRUCTURE:

C:\ZMAIL
|
+---USER-1
|   |	SIGNATUR.TXT
|   |	ZMAIL.RC
|   |
|   \---MAIL
|	|   MAILBOX
|	|
|	\---DETACH.DIR
|
+---USER-2
|   |	SIGNATUR.TXT
|   |	ZMAIL.RC
|   |
|   \---MAIL
|	|   MAILBOX
|	|
|	\---DETACH.DIR
|
etc.


ZMAIL.INI:

[Environment]
ADDRESS_BOOK=zerex:72722   <- hostname:port of directory services (optional)
MAILHOST=zen		   <- hostname of server running POP3
;MAILHOST=zaibatsu:15232   <- hostname:port of server running Zync (optional)
SMTPHOST=z-code 	   <- hostname of server running sendmail
TZ=PST8PDT
USER=USER-1		   <- username (omit if multiple users)
ZCNLSERV=zyrcon:2721	   <- hostname:port of server running NLS (optional)
ZMHOST=zymurgy		   <- hostname of PC running Z-Mail
ZMLIB=w:\zmail\lib	   <- points to LIB directory (see tree above)
ZMROOT=w:\zmail 	   <- points to top-level ZMAIL directory (above)


<private>.INI:

Each user has a directory that contains their personal settings, as well as
any settings that override the system settings as established in ZMAIL.INI.
The name of the directory and the $USER.INI file within it is the user's logon
ID, such as BONNIES for Bonnie Smith.  It must be no more than 8 characters
in length, in order to follow DOS file naming conventions.

[Environment]
FOLDER=c:\zmail\user-one\mail	       <- points to directory
HOME=c:\zmail\user-one		       <- points to directory
MAIL=c:\zmail\user-one\mail\mailbox    <- points to file (default mailbox)
REALNAME=Wazmo X. Nariz 	       <- USER-1's real name
TMPDIR=d:\tmp			       <- directory for temporary files
USER=user-one			       <- user's logon ID

;if using POP3 to receive mail, ignore these next two settings

;ZYNCHOST=zaibatsu:1523 	       <- host:port of server running Zync
;ZYNC_OPTIONS=prefs,config,realname    <- Zync options


--------- Z-Mail for Windows 4.0 SHARED NETWORK INSTALL ---------

A Z-Mail 4.0 Shared installation allows an Administrator to specify default 
locations for user files.  NOTE: The Administrator _must_ have write access 
to the locations where the Z-Mail files are to installes, and if Windows is 
running from a network drive, then the Admin must also have write rights to 
the \WINDOWS\SYSTEM directory.  NOTE: it is advisable to consistently map a 
Personal drive (usually P:\ or H:\) for your users, and have them use that 
as a default Z-Mail $USER location.  This provides for easier LAN management 
and security.

Z-Mail's shared installation installs Z-Mail on a shared drive you
choose during the installation. While installing Z-Mail to a shared
drive, you can provide system defaults for your users, such as
SMTP host name and port number.

Before attempting to install Z-Mail on a shared drive:

It is recommended that your users have only read access to the
directory where you are installing a shared copy of Z-Mail.

If your users have write access to the shared directory, they can
overwrite the ZMAIL.INI file, which is where you provided system
defaults for all your users.

After you've completed your Z-Mail installation to a shared drive,
your users must run the installation from the shared drive on
their local PCs in order to create necessary configuration files
and the Z-Mail Program Manager group and icon.

To begin a shared installation, from your temporary installation
directory, use Program Manager to run SETUP.EXE with the shared option:

SETUP.EXE SHARED

Each user will then only need to run the SETUP.EXE program without any options.

      <a name="IIIi2"><b>2. What is a "NETCOPY" install?</b></a>

A Z-Mail for Windows 4.0 netcopy installation does not actually install Z-Mail.
A netcopy installation enables you to provide a zmail.ini file that contains
system defaults your users see when they install Z-Mail from the
network drive or from two distribution disks.

Before starting a netcopy installation:

If you intend to distribute the Z-Mail installation program on
floppy disks, and you do not have DISK1 and DISK2 subdirectories
in your temporary installation directory, you must unpack the
archive ZWIN40.EXE again by running the following command in
Program Manager:

ZWIN40.EXE -d

This maintains a directory structure that makes copying to disks
easy.

To begin a netcopy installation, from your temporary installation
directory, use Program Manager to run SETUP.EXE with the
netcopy option:

SETUP.EXE NETCOPY

Make sure that you spell NETCOPY correctly, also.  Z-Mail will not warn you
about mispellings if you make a mistake.

<a name="IV"><b>IV. User Maintence</b></a>

  <a name="IVA"><b> A. How do I add / remove users with Z-Mail 3.21?</b></a>

To add users with Z-Mail 3.21 you will need to first remove the "USER=" field
in the C:\WINDOWS\ZMAIL.INI file.  Then create a directory structure under
C:\ZMAIL based on the username of your new user.  Copy the .INI files from your
original C:\ZMAIL\$USER directory to the new location, and edit all folder
references so that they point to the corrrect locations in the new tree.

   <a name="IVB"><b>B. How do I add or remove users with Z-Mail 4.0?</b></a>

For existing users from an upgrade all you need to do is "Browse" for theit 
$USER.INI from the Login screen, after entering their $USERNAME and hitting 
[enter].  If the user exists on a network drive, and is accessing his account 
on several machines, note that the drives must be mapped the same on all
involved machines.

Alternatively, a new user can be added just by entering the new username at 
the Login Screen, hitting [enter], and choosing New.  Just start a new user 
profile.

  <a name="IVC"><b> C. How do I change a user's POP-3 server, or SMTP host?</b></a>

Z-Mail 3.21

These settings can be changed by modifying the values in the MAILHOST and 
SMTPHOST entries in the C:\ZMAIL\$USER\$USER.INI file.

Z-Mail 4.0

Adjust the POP-3 server and SMTP server entries in the Setup dialog from the 
Login Screen.

<a name="V"><b>V. Z-Mail Troubleshooting</b></a>

   <a name="VA"><b>A. Network Problems</b></a>

      <a name="VA1"><b>1. What is a "Cannot connect to network - WINSOCK not found" error?</b></a>

It is likley that Z-Mail could not process a WSAStartUp call, which can result
from a missing WINSOCK compatible TCP/IP network stack, or from a missing
WINSOCK.DLL file.  Check your PATH to see that your stack is accessable by
Windows applications.

      <a name="VA2"><b>2. Where can I find a WINSOCK-compatible TCP/IP network interface?</b></a>

Z-Mail now ships with one:

	<a href="ftp://ftp.ncd.com/pub/z-code/supported/z-mail/windows/4.0/ncdtcpip.exe">ftp://ftp.ncd.com/pub/z-code/supported/z-mail/windows/4.0/ncdtcpip.exe</a>

      <a name="VA3"><b>3. In UUPC mode Z-Mail complains about WINSOCK.  How can I fix that?</b></a>

This is only true for Z-Mail 3.2x, and not for Z-Mail 4.0.  NCD suggests using
a "dummy WINSOCK" to remedy this.  (see next question)

      <a name="VA4"><b>4. What is a dummy WINSOCK.DLL and where do I find one?</b></a>

The dummy WINSOCK.DLL (stub) is userful for people who will use Z-Mail 3.2x 
in UUPC mode only, without the need to ever hook up to a network.  The file 
WSCKSTUB.DLL should be placed in the C:\WINDOWS directory and renamed to 
WINSOCK.DLL.

It can be found at:

	<a href="ftp://ftp.ncd.com/pub/z-code/supported/z-mail/windows/patch/wsckstub.dll">ftp://ftp.ncd.com/pub/z-code/supported/z-mail/windows/patch/wsckstub.dll</a>

      <a name="VA5"><b>5. Will Z-Mail work with WINSOCK 2.0?</b></a>

Yes.

     <a name="VA6"><b> 6. How can I debug my WINSOCK TCP/IP stack?</b></a>

NCD offers a unique debugging tool for WINSOCK compatible stacks, called
WSASNOOP.  It, and it's instructions for use, can be found at:

ftp://ftp.ncd.com/pub/z-code/supported/z-mail/windows/debug/wsasnoop.zip

   <a name="VB"><b>B. Receiving Email</b></a>

      <a name="VB1"><b>1. What POP-3 servers do you recommend (NFS)?</b></a>

First and foremost NCD recommends Z-POP because of its robust POP-3
capabilities and enhances features for dealing with synchronization, remote
preferences and configuration.  Z-POP is free and can be found at:

ftp://ftp.ncd.com/pub/z-code/supported/z-pop/current/

We also recommend the University of Washington's iPOP3d server, which is
currently contained as a subset of the IMAP sources at:

ftp://ftp.cac.washington.edu/imap/

      <a name="VB2"><b>2. What is Mailbox Synchronization?</b></a>

Z-Mail synch is a feature of the interaction that is possible between Z-Mail 
for Windows 4.0 and the Z-POP mail server. A better explaination that space 
allows for here are available from both:

<a href="http://www.ncd.com/Z-Code/zproducts/wp-synchronization.html">http://www.ncd.com/Z-Code/zproducts/wp-synchronization.html</a>
<a href="ftp://ftp.ncd.com/pub/z-code/supported/doc/windows/sync.doc">ftp://ftp.ncd.com/pub/z-code/supported/doc/windows/sync.doc</a>

      <a name="VB3"><b>3. Do you support IMAP?</b></a>

IMAP support is planned for future releases of Z-Mail.

      <a name="VB4"><b>4. What alternatives to POP-3 do you support?</b></a>

If you want to install Z-Win on another system and have it work with an
NFS-mounted spool folder all you'll need to do is go through a standard
SETUP and afterward make the following changes:

1. In Z-Mail 4.0 use the Login's Setup dialog to set your Incoming Mail's 
   "Inbox file name:" to the full path and file of your NFS-mounted mail 
   spool: "DRIVE:\PATH\TO\UNIX\SPOOLDIR\FILE"

2. Turn off the "Download new mail when connecting" option in the Login's 
   Setup dialog "Incoming Mail" section.

3. Edit your C:\ZMAIL\USERS\$USER\ZMAIL.RC file to add the entry:

   ###################
   # sets use_pop to 
   # the number zero 
   # for NFS-mounting
   set use_pop=0
   ###################

4. That's it!

      <a name="VB5"><b>5. How do I set up a vacation filter?</b></a>

NCD suggests using host-based vacation filters.  See also:

	<a href="http://www.wsr.ac.at/cgi-bin/man/vacation/1#sect0">http://www.wsr.ac.at/cgi-bin/man/vacation/1#sect0</a>

      <a name="VB6"><b>6. Why does Z-Mail download duplicates of all my email?</b></a>

You can keep your mail on your mail host (not on your PC) if you set the
pop_options variable to the value preserve (not all POP-3 servers support this
functionality).

If you set this variable and still receive duplicate copies of each message,
your POP-3 server does not support the "last" command, used to preserve mail.
Both the University of Washington's iPOP3d Server and Z-Code Software's Z-POP
server support the full POP-3 feature set, including "last".

If you wish, you may disable mail preservation entirely by unsetting the
pop_options variable and removing lines beginning with POP_OPTIONS= from
C:\WINDOWS\ZMAIL.INI and C:\ZMAIL\$USER\$USER.INI.

      <a name="VB7"><b>7. What is a pop_dropcopy ERROR?</b></a>

The Z-POP config file contains a number of directives that should be set by 
your site's system administrator.  In the casee of a pop_dropcopy ERROR the 
SPOOL directive could be pointing to an incorrect location.  It is also 
important to note that Z-POP should be setgid the same as the mail spool 
directory:

% ls -ld /var/mail
drwxrwxr-x   3 root   mail           512 Sep 21 17:10 /var/mail/

% ls -l zpop
-rwxr-xr-x   1 root     bin        24081 Sep 21 16:51 zpop

% chgrp mail zpop
% chmod 2755 zpop
% ls -l zpop
-rwxr-sr-x   1 root    mail        24081 Sep 21 16:51 zpop


      <a name="VB8"><b>8. What is the init_check option for POP-3?</b></a>

The init_check option found in the "pop_options" variable listing is used for 
checking the user's email when starting a Z-Mail session, or when entering 
"connected mode".  This option cannot be set from the variables list, and is 
instead set from the login's setup dialog, under Incoming Mail as the 
"Download new mail when connecting" option.  Turning this off is useful if 
you are using NFS to mount your mail spool, connecting via Z-POP Synch, or 
are just plain interested in getting into Z-Mail a little quicker.

      <a name="VB9"><b>9. Why are my "Quick Check" synch scenerios greyed out?</b></a>

Because synchronization scenarios are potentially destructive or can cause
message duplication, we try to create an environment where things are set up
properly for the user - for example, one does not want generally want to use
POP and Sync simultaneously unless one is really paying attention to what
they're doing.  In the case of Quick Sync, the  scenarios were designed to be
used as a complete set: Check out, get new mail via sync, and check back in.
So, we disabled the Quick Sync options on the menu if get mail via sync is not
enabled (pop_options=use_sync).

All sync scenarios are available through the "other scenarios" menu at all
times.

     <a name="VB10"><b>10. Why does some of my new mail show up out of order after a synch?</b></a>

Z-POP client / server code doesn't request / send messages in order by date.
This results in users sometimes getting new mail out of order.  (The sort
stuff only exists in zmenu_qs_checkout.)  This Z-Script function should be
useful to users who would like to defined sort criteria.  Cut and paste into
your ZMAIL.RC file:

####################
# The following two functions and two interpose commands sort new mail
# delivered via a synchronization scenario according to the value of
# $sort (if set) or by date sent.

function presort() {
    set __sort_count = $(%t)
}

function newsort() {
    # Don't sort empty folder
    if $(%t) == 0
	return 0
    endif

    # Define "new mail" as "folder has more messages than before"
    if $(%t) <= $__sort_count
	return 0
    endif

    if $?sort
	sort $sort
    else
	sort -d
    endif
    if $?newmail_scroll
	:n | redraw
    endif
}

interpose -before zpop_sync presort
interpose -after zpop_sync newsort
####################

     <a name="VB11"><b>11. What is a "pop_stat" error, and how do I get around it?</b></a>

To get around a pop_stat error, which occurs when Z-Mail and Z-POP use
synch to create a temporart maildrop that is so big it tiimes out a serial 
setting, we  recommend bumping the value of the IOTimeoutSeconds (Serial 
Read/Write Timeout (secs) in the Setup UI) from 30 to 60 (or more) seconds.

      <a name="VB12"><b>12. What is a "ZHB2" error?</b></a>

This results when a user is attempting to synchronize mail between Z-Mail and 
an older version of Z-POP (or a generic POP-3 server) that does not support 
this feature.

   <a name="VC"><b>C. Sending Email</b></a>

      <a name="VC1"><b>1. What is a "SMTP error - connection refused"?</b></a>

This can happen when Z-Mail tries to start a SMTP session with a bad PC
hostname, which the SMTP server does not recognize.  Check your login's setup 
screen to verify that your PC hostname is set correctly.  This information 
can be stored in the form "ZMHOST=hostname" in your $USER.INI file.

      <a name="VC2"><b>2. How do I save a copy of my outgoing email?</b></a>

Setting the "record" variable will create a file for copies of your outgoing
email.

      <a name="VC3"><b>3. Do you support UUCP (UUPC)?</b></a>

Not offically.  Z-Mail 4.0 now has asynch serial support, negating the need 
for UUPC/UUCP based mail transfer, though the Z-Script hooks that were used 
in Z-Mail for Windows 3.2x still work in 4.0.  Also, keep in mind that UUPC's 
paradigm requires that only one user access Z-Mail on a given PC, and it 
should not be used in multiple-user configurations.


Installing UUPC/extended on your PC for use with Z-Mail for Windows
-------------------------------------------------------------------

Obtain the latest release of uupcx from:

         <a href="ftp://ftp.z-code.ncd.com/pub/z-code/unsupported/windows/uupc/">ftp://ftp.z-code.ncd.com/pub/z-code/unsupported/windows/uupc/</a>

To install UUPC/extended on a PC to set up a uucp e-mail connection between
a UNIX host and your PC follow these steps...

        01) Make a directory c:\uupc
        02) Copy the file uupcx12.zip into c:\uupc
        03) Extract with 'pkunzip -d uupcx12.zip'
        04) Add this line to autoexec.bat...
                if exist c:\uupc\uupc-set.bat call c:\uupc\uupc-set.bat
        05) Add c:\uupc\bin to the search path set in autoexec.bat
        06) Change the directory c:\uupc\home\jcole to your e-mail name
        07) Edit the file c:\uupc\systems for your UNIX host connection
        08) Edit c:\uupc\uupc.rc and c:\uupc\home\yourname\uupc.rc
            appropriately for your environment
        09) Edit c:\uupc\uupc-set.bat and change 'jcole' to your e-mail
            name as in 6 and 7 above. Also change the timezone setting
            if you're not on the US West Coast timezone.
        10) Edit c:\uupc\bin\uudial.bat and change the system name
            (after the '-s') to the name of the UNIX system your PC
            connects to for e-mail.

Connecting from your PC to a UNIX Mail Host
-------------------------------------------

The file UUDIAL.BAT is what you run to invoke a connection with your UNIX
uucp host to send e-mail messages you've queued up and receive mail queued 
up for you on the UNIX side. Three things execute when UUDIAL.BAT is run.

The first thing called in UUDIAL.BAT is the UUCICO.EXE program, which
is what connects the PC to the UNIX uucp host and exchanges e-mail and/or
files. The 'r' parameter specifies 'Master' role <you initiate the call>, 
and the 'x' parameter specifies the debugging level <goes to stdout and 
also to c:\uupc\spool\uucico.log>. The 's' parameter specifies the uucp
system to connect to.

After UUCICO.EXE finishes UUXQT.EXE is invoked to deliver mail in the
uupc queue to local uupc mailboxes in C:\UUPC\MAIL.

Lastly a program provided by Z-Code named NEWMAIL.EXE is invoked to
process mail delivered to a uupc mailbox and append it to it's Z-Mail
mailbox counterpart. Newlines in the uupc-delivered mail folder consist
of CRLF pairs, and NEWMAIL converts these to LF's only. As well any
Ctrl-A delimters are stripped. This is necessary as Z-Mail for Windows
parses files in a particular fashion to establish MIME body part 
boundaries, and the CRLF pairs confuse that process.

If you want to invoke UUDIAL.BAT from within Windows you should use the
UUDIAL.PIF (Program Information File) file. You may add this to a Program
Manager group. It will execute in the background in a small DOS window
which can be iconified if you like.

As well UUDIAL.PIF can be invoked from a running Z-Mail for Windows by
invoking the Z-Script command

        sh -iconic UUDIAL.PIF

from either the command line in the main window or by defining a button
to call that command when clicked. In either case the uucp connection will
be executed from within an iconized DOS window which will run in the
background unobtrusively.

Lastly in order to have UUDIAL.PIF called periodically from Z-Mail for
Windows while it is up and running place the following function and
variable definitions in either the global Z-Mail system initialization
file (SYSTEM.RC in the Z-Mail lib directory) or in your personal
Z-Mail initialization file (ZMAIL.RC in your Z-Mail home directory). 
The unit of time specified for 'fetch_timeout' is in minutes. It's
value denotes how often the fetch_mail_hook() function will be called.  The 
use_pop variable can also be set to 0 (zero) and will enable you to check mail
without using POP-3.

function fetch_mail_hook() {
    sh -iconic uudial.pif
}
set fetch_timeout=15
set use_pop=0

Setting up a UUCP account on the UNIX Side
------------------------------------------

On the UNIX host which serves as a mail relay there are basically four
files (on a Sun BSD system) which have to be edited. They are...

        /etc/uucp/Systems       ...when to allow uucp connections
        /etc/uucp/Permissions   ...what to do when connecting
        /etc/passwd             ...account info including password
        /etc/sendmail.cf        ...specify PC as a uucp connection for mail


A few other things you should know
----------------------------------

The O'Reilly & Associates book "Managing UUCP and Usenet" is an excellent 
general reference. Well worth the money. 

The file in the top level uupc directory named HOWTOGET.TXT is from the
original UUPC/extended distribution, and explains where to get the latest
version of UUPC/extended on the Internet and other places. 

This zip'd up version of UUPC/extended 1.12 is provided merely to facilitate
implementation by those who may not be familiar with setting up UUPC from
scratch. I highly encourage anyone interested in getting the original
complete distribution of UUPC/extended to consult HOWTOGET.TXT. Source
code for UUPC/extended is also available in the complete distribution.

      <a name="VC4"><b>4. Do you support PGP (Pretty Good Privacy) for email encryption?</b></a>

Yes.  Several Z-Scripts have been penned by our user community for the Windows
line of products.  NCD Software is also currently working with several vendors
for Z-Script integration with encryption software.  Please discuss the terms
of PGP availability with your NCD sales representative or qualified NCD
reseller.

The PGP Authorization Form can be found at: 

	<a href="http://bs.mit.edu:8001/pgp-form.html">http://bs.mit.edu:8001/pgp-form.htm</a>

Scripts for integrating PGP with ZMail:

Author: Guy Berliner 
<a href="ftp://ftp.netcom.com/pub/be/berliner/readme.html">ftp://ftp.netcom.com/pub/be/berliner/readme.html</a>
<a href="ftp://kaiwan.com/user/mckinnon/pgp4zm.zip">ftp://kaiwan.com/user/mckinnon/pgp4zm.zip</a>

      <a name="VC5"><b>5. How do I avoid losing email with bad addresses?</b></a>

To avoid losing mail after mistyping an address and getting an SMTP error,
set picky_mta += precheck.  This option is set by default in Z-Mail 4.0.

   <a name="VD"><b>D. Filtering Email</b></a>

       <a name="VD1"><b>1. How come my autoreply only works on the first filtered message?</b></a>

There is a slight discrepancy in the zmfilter_reply function:  You will need 
to edit the function (located in C:\ZMAIL\LIB\SYSTEM.RC so that it looks 
like this:

	function zmfilter_reply() {
	    foreach m $input 'msg_list - $m ; zmfilter_reply_each $1;'
	}


NOTE: There needs to be a trailing ';' to reset the status for the foreach 
      loop.

<a name="VI"><b>VI. Graphical User Interface</b></a>

   <a name="VIA"><b>A. Where did all my Z-Mail 3.21 buttons go when I upgraded?</b></a>

Most of the buttons seen as defaults in Z-Mail 3.21 are now commented out in
Z-Mail 4.0.  This was done to remove duplication between the Toolbar and the 
Button Panel. All you need top do is edit the C:\ZMAIL\LIB\ZMAILMNU.RC file 
and uncomment the buttons you want.

   <a name="VIB"><b>B. Where did all my Z-Mail 3.21 toolbar items go when I upgraded?</b></a>

These are also commented out in the C:\ZMAIL\LIB\ZMAILMNU.RC file.  This was 
done to remove duplication between the Toolbar and the Button Panel. 

   <a name="VIC"><b>C. How do I use one of my own icons or bitmaps to the toolbar?</b></a>

The default icons use 24x24 bitmaps. If your bitmap is smaller or larger
than 24x24, it will not be centered on the toolbar button. There are four
toolbars.  At the command line or resource file, specify which
toolbar to which you want to add an icon.

button -B MainFrameToolbar
button -B MainChildToolbar
button -B MessageChildToolbar
button -B ComposeChildToolbar

You may not use external bitmaps in the text button panels.  Enter the button
command following the syntax in the online help.  After the '-icon' option,
enter the full path to the ICO or BMP file.  For example:

button -n -name connect	 -label 'Connect/Disconnect' -icon
'c:\zmail\icons\discon.ico'  -on-icon
'c:\zmail\icons\connect.ico' -value '$?connected'

button -n -name create -label 'Create New'  -icon 'c:\zmail\icons\compose.bmp' mail

   <a name="VID"><b>D. Where can I find a listing of Z-Mail for Windows toolbar icons?</b></a>

Note: To change a toolbar icon definition, with the size defined as "medium",
all you need to add is: ADDRBOOK_BMP instead of the full name: MD_ADDRBOOK_BMP.

///////////////			////////////////
//				//
// Small Bitmap			// Medium Bitmap
//				//
				
SM_ADDRBOOK_BMP			MD_ADDRBOOK_BMP
SM_ALIAS_BMP			MD_ALIAS_BMP
SM_ATTACH_BMP			MD_ATTACH_BMP
SM_ATTACH_TB_BMP		MD_ATTACH_TB_BMP
SM_CANCEL_TB_BMP		MD_CANCEL_TB_BMP
SM_CLOSE_TB_BMP			MD_CLOSEFOLDER_BMP
SM_COMPOSE_BMP			MD_CLOSE_TB_BMP
SM_CONNECT_TB_BMP		MD_COMPOSE_BMP
SM_COPY_TB_BMP			MD_CONNECT_TB_BMP
SM_CUT_TB_BMP			MD_COPY_TB_BMP
SM_DATES_BMP			MD_CUT_TB_BMP
SM_DELETE_TB_BMP		MD_DATES_BMP	
SM_DISCONNECT_TB_BMP		MD_DELETE_TB_BMP
SM_ENVELOPE_BMP			MD_DISCONNECT_TB_BMP
SM_FILTERS_BMP			MD_ENVELOPE_BMP
SM_FINDER_BMP			MD_FILTERS_BMP
SM_FUNCTIONS_BMP		MD_FINDER_BMP
SM_FWD_TB_BMP			MD_FUNCTIONS_BMP
SM_GETMAIL_TB_BMP		MD_FWD_TB_BMP	
SM_HEADERS_BMP			MD_GETMAIL_TB_BMP
SM_HELP_BMP			MD_HEADERS_BMP
SM_INCLUDE_TB_BMP		MD_HELP_BMP	
SM_MAIL_BMP			MD_INCLUDE_TB_BMP
SM_NEWMAIL_BMP			MD_LAPTOP_BMP
SM_NEXT_TB_BMP			MD_MAIL_BMP
SM_OPEN_BMP			MD_NEWMAIL_BMP
SM_PASTE_TB_BMP			MD_NEXT_TB_BMP
SM_PINUP_BMP			MD_OPEN_BMP
SM_PREV_TB_BMP			MD_PASTE_TB_BMP
SM_PRINTER_BMP			MD_PINUP_BMP
SM_READ_BMP			MD_PREV_TB_BMP
SM_REPLYALL_TB_BMP		MD_PRINTER_BMP	
SM_REPLY_TB_BMP			MD_READ_BMP
SM_REPL_BMP			MD_REPLYALL_TB_BMP
SM_SAVE_TB_BMP			MD_REPL_BMP
SM_SEARCH_BMP			MD_SAVE_TB_BMP
SM_SEND_TB_BMP			MD_SEARCH_BMP
SM_SERIAL_TB_BMP		MD_SEND_TB_BMP	
SM_SORT_BMP			MD_SERIAL_TB_BMP
SM_SPELL_BMP			MD_SORT_BMP
SM_SRCH_BMP			MD_SPELL_BMP
SM_TEMPLATES_BMP		MD_SRCH_BMP	
SM_UNDELETE_TB_BMP		MD_TEMPLATES_BMP	
SM_UPDATE_TB_BMP		MD_UPDATE_TB_BMP	
SM_VARIABLES_BMP		MD_VARIABLES_BMP	

   <a name="VIE"><b>E. How do I "pinup" my MDI Child windows Z-Mail 4.0?</b></a>

In each MDI Child Toolbar definition in the C:\ZMAIL\LIB\ZMAILMNU.RC there 
are remarked references to the "Pinup" button.  All you need to do is uncomment
these definitions to use the pinup command.  This operation will be enhanced in
future versions of Z-Mail, and is not highly recommended.

   <a name="VIF"><b>F. I have a laptop.  How can I set Z-Mail 4.0 to 640x480?</b></a>

In your C:\ZMAIL\LIB\ZMAILMNU.RC file, uncomment out the line:

#button -n -name laptop -label 'Laptop' -icon laptop_bmp 'laptop'

   <a name="VIG"><b>G. How do I paste addresses into a Z-Mail 4.0 compose "To:" field?</b></a>

Z-Mail for Windows 4.0 uses the standard "Shift+Ins" to paste into all 
editable composition fields.  Z-Mail also supports the standard 
"Crtl+Insert" for copying.

   <a name="VIH"><b>H. How do I start Z-Mail minimized?</b></a>

Z-Mail 4.0 now remembers window states between sessions.  In order to start
 Z-Mail in minimized state each time, add the following function to your
zmail.rc:

 function exit_hook() {
    iconify
 }

This will ensure that you iconify Z-Mail before exiting each session, and
Z-Mail
will remember this state the next time you start the program.

Note:  There is a known bug related to this feature.  When you restore Z-Mail's
window size, space is not distributed correctly within and between panes.

   <a name="VIi"><b>I. How do I bypass the Z-Mail login dialog?</b></a>

Z-Mail 4.0 allows you to bypass the login screen.  Note that you may only
bypass the login screen if you store your user password.  This may be an
unacceptable security risk at some sites.

1) In Z-Mail's installation program, set the toggle that allows users to store
encrypted passwords.

2) In the Z-Mail User Setup dialog, select the store password option from the
User Information pane.

3)  Enter your password in the Login dialog, and click Connect.  Your password
is now encrypted and stored in your $user.ini.  Quit Z-Mail.

4) Hand-edit the [Environment] section of your $user.ini to include the line:
StartOffline=False

5) In program manager, create an icon with the command line:
c:\zmail\zmail16.exe @c:\zmail\users\yourname\yourname.ini

where "c:\zmail\zmail16.exe" is the full path to the Z-Mail executable and
"c:\zmail\users\yourname\yourname.ini" is the full path to your $user.ini file.
Note that there is no space after the @ and the path to the ini file.

6) Double click on the icon you have created.  Z-Mail should not display the
login dialog, but go straight to the Main Summaries window.

   <a name="VIJ"><b>J. How do I save an alias after changing it?</b></a>

After modifying an alias through the alias dialog, remember to click on 
the "Define Alias" button, or the current state will not be saved.

   <a name="VIK"><b>K. Why doesn't Z-Mail remember my printer setup?</b></a>

Z-Mail uses the same printer setup API that other applications, like "Notepad"
use, and therefor it falls into some of that API's limitations.  The most 
common example is the default setup is always reset to whatever the control 
panel is set to, and not the most recent settings within Z-Mail.

   <a name="VIL"><b>L. Can I use the Address Browser offline?</b></a>

Yes.  There is currently an unsupported Offline Address Browser that works 
only with Z-Mail 4.0 and the Z-Mail MAPI.DLL.  It can be found in:

<a href="ftp://ftp.z-code.ncd.com/pub/z-code/unsupported/windows/Visual_Basic/Browser/">ftp://ftp.z-code.ncd.com/pub/z-code/unsupported/windows/Visual_Basic/Browser/</a>

The files in this directory show how to use the MAPIRunScript
function (in the Z-Code MAPI.DLL) in a Visual Basic application.

To use...

	1) Make sure you have a copy of VBRUN100.DLL in the
	   \WINDOWS directory on your PC.

	2) Source the z-script file "EXBROWSE.ZSC" in the
	   $ZMLIB\SYSTEM.RC file on your PC.

	3) Make sure you're running a beta version of Z-Win
	   4.0 (earlier known as 3.3), and that you have the
	   Z-Code MAPI.DLL in the ...\WINDOWS\SYSTEM directory
	   on your PC.

The MAPIRunScript function provides a way for an external MAPI-aware
Windows app to pass arbitrary z-script to Z-Win. This is a very 
powerful hook, and the included test application, BROWSER.EXE, created
with Visual Basic v1.0, demonstrates the hook as it might be used
from an external directory service browser program to pass an e-mail
address to Z-Win. 

Since Z-Win can't make use of the address_book hook while in
disconnected mode the VB browser can be used to provide access to a
local flat file directory for Z-Win when in disconnected mode.

A few things to know...

	The BROWSER.EXE file assumes there will be a flat file
	directory named ADDRESS.TXT in the same directory it
	is located in.

	The format for user entries in ADDRESS.TXT is...

		Descriptive info|&&|e-mail address

	This is hard coded but may be changed in the VB source files (which
	are included in the ZIP file). The string |&&| which is embedded in
	a user 'record' corresponds to setting lookup_sep to the same string
	when using the built in Z-Win online browser. This will provide for
	using e-mail addresses which contain spaces (comments).

	Any lines in ADDRESS.TXT which begin with a "#" will be treated as
	comments, and any lines which do not contain the separator string
	"|&&|" will not be considered user record lines. This allows for
	ADDRESS.TXT to be managed by ZPOP central config capability,
	assuming you're willing to keep BROWSER.EXE in $ZMLIB (the browser
	and the address file must be in the same directory).

	One undocumented feature is that if you leave the pattern field blank
	and click the Search button *all* of the valid user entries in
	ADDRESS.TXT will populate the match list box.

   <a name="VIM"><b>M. How can I view uuencoded inclusions in Z-Mail 3.2?</b></a>

If a file has actually been "included" into the message body, as some 
mailers will do, then Z-Mail 3.2 will not treat it as an attachment.  
You will need to Z-Script around this to detach these "inclusions:"

	##############################
	# Place in your zmail.rc file
	#
	# Function to uudecode files
	# included in the body of a
	# mail message, not attached.
	# Requires a dos UUDECODE.EXE
	##############################
	function uudecode_inclusion {
	 compcmd save-to-file c:\temp\ztemp.uue
	 sh uudecode c:\temp\ztemp.uue
	 sh del c:\temp\ztemp.uue
	}
	#
	button -window message UUdecode uudecode_inclusion
	##############################

<a name="VII"><b>VII. Z-Script, Filters, Functions</b></a>

   <a name="VIIA"><b>A. Where can I learn about Z-Script?</b></a>

Currently, the "Z-Script Cookbook" provides the most definitive guide on the 
in's and out's of Z-Script.  It contains a reference guide for all commands 
and variables on each supported platform, as well as an in-depth tutorial 
on how to get started.

The Z-Script Cookbook can be found at:

	ftp://ftp.ncd.com/pub/z-code/supported/doc/zscript

Z-Mail for Windows / Z-Script References can be found at:

	ftp://ftp.ncd.com/pub/z-code/supported/doc/windows

   <a name="VIIB"><b>B. How can I get Z-Mail to automatically run filters and
      open folders during startup?</b></a>

By utilizing a startup_hook function in your personal C:\ZMAIL\$USER\ZMAIL.RC,
which is the same as $HOME\ZMAIL.RC in 4.0.

  function startup_hook() {
      close #0
      open -filter $mail
      open +folder1
      open -filter +folder2
      folder %
  }

   <a name="VIIC"><b>C. What other automatic "hook" functions are available?</b></a>

Z-Mail 4.0 supports three automatic hook functions:

startup_hook
send_mail_hook
exit_hook

   <a name="VIID"><b>D. What happens to my zmail.rc file when I upgrade?</b></a>

Nothing happens to your old ZMAIL.RC file.  The old $USER directory structure
is maintained during the upgrade, so that the user can edit their custom .RC
files and place them into the new C:\ZMAIL\USERS\$USER directory.

<a name="VIII"><b>VIII. Other Sources of Information</b></a>

   <a name="VIIIA"><b>A. Where can I find additional info on Z-Mail for Windows?</b></a>

Offical documentation in both PostScript and .pdf formats, as well as online 
hypertext, on the following subjects can be found at:

		    <b>---- Z-Mail for Windows ----</b>
<i>Install Guides</i>
3.21	<a href="http://www.ncd.com/Z-Code/zsupport/win321-install.html">http://www.ncd.com/Z-Code/zsupport/win321-install.html</a>
4.0	<a href="http://www.ncd.com/Z-Code/zsupport/win4000-install.html">http://www.ncd.com/Z-Code/zsupport/win4000-install.html</a>
	<a href="ftp://ftp.ncd.com/pub/z-code/supported/doc/windows/zwin40ig.pdf">ftp://ftp.ncd.com/pub/z-code/supported/doc/windows/zwin40ig.pdf</a>

<i>User Guides</i>
4.0	<a href="ftp://ftp.ncd.com/pub/z-code/supported/doc/windows/userguid.pdf">ftp://ftp.ncd.com/pub/z-code/supported/doc/windows/userguid.pdf</a>

<i>Synchronization</i>
WWW	<a href="http://www.ncd.com/Z-Code/zproducts/wp-synchronization.html">http://www.ncd.com/Z-Code/zproducts/wp-synchronization.html</a>
FTP	<a href="ftp://ftp.ncd.com/pub/z-code/supported/doc/windows/sync.doc">ftp://ftp.ncd.com/pub/z-code/supported/doc/windows/sync.doc</a>

<i>Info on Windows TCP/IP</i>
WWW	<a href="http://www.rtd.com/pcnfsfaq/faq.html">http://www.rtd.com/pcnfsfaq/faq.html</a>

		       <b>---- Z-POP Server ----</b>
<i>Z-POP Server</i>
1.0	<a href="http://www.ncd.com/Z-Code/zsupport/pop-install.html">http://www.ncd.com/Z-Code/zsupport/pop-install.html</a>

			<b> ---- Z-Script ----</b>
<i>Z-Script Cookbook</i>
FTP	<a href="ftp://ftp.ncd.com/pub/z-code/supported/doc/zscript/Cookbook.pdf">ftp://ftp.ncd.com/pub/z-code/supported/doc/zscript/Cookbook.pdf</a>

			   <b>---- Misc. ----</b>
<i>Adobe Acrobat (.pdf viewer)</i>
WWW	<a href="http://www.adobe.com/Acrobat/AcrobatWWW.html">http://www.adobe.com/Acrobat/AcrobatWWW.html</a>

WWWeb searches constantly turn up new, private Z-Mail support pages, though 
I recommend highly the comp.mail.zmail newsgroup for beginning and advanced 
user community support. 

Also, the newsgroups comp.mail.mime and comp.mail.zmail are archived
at NCD and will be maintained as a public service to the electronic
messaging community.

	<a href="ftp://ftp.z-code.com/pub/usenet/comp.mail.mime">ftp://ftp.z-code.com/pub/usenet/comp.mail.mime</a>
	<a href="ftp://ftp.z-code.com/pub/usenet/comp.mail.zmail">ftp://ftp.z-code.com/pub/usenet/comp.mail.zmail</a>

The first of these is a large collection of messages posted to
comp.mail.mime, it has well over six thousand articles dating
back as far as December of 1992, although there may still be some
gaps.

The second archive is a complete collection of messages posted to
comp.mail.zmail.  This archive is much smaller, since that group is
much younger, but it should contain every article posted to the group
since the day it was born.

New articles are merged into the existing archives daily.  Articles
are archived three ways in three directories:

    number/

        This directory holds every article in the archive.  Each
        article appears in its own sequentially-numbered file.  The
        entire directory looks like one huge MH-format mail folder.
        The oldest article is named "1", followed by "2", "3", and so
        on.

    month/

        This directory holds one small archive for each month and year
        of the newsgroup.  Each monthly archive is in its own
        subdirectory, named using a pattern of "yymm".  So all
        articles from January, 1995 would be found in the directory
        named "month/9501/".

        Within each month's subdirectory, each article appears in an
        individual file whose name is a number.  The numbers will not
        be strictly sequential though -- rather, they will match up
        with the same numbers used in the "number/" directory.  So if
        a grand total of six thousand articles had been archived by
        the end of one month, the next month's archive will start with
        an article named "6001".

        You can also download an entire month's worth of articles at
        once, as a tar archive.  Just add ".tar" to the end of any
        subdirectory name, such as "month/9501.tar", and get that as
        though it were a file.  The entire contents of that directory
        will be streamed to you as a single tar archive.  You can also
        use ".tar.Z" or ".tar.gz" to speed things up if you have
        decompression tools.

    subject/

        This directory is also split into subdirectories, each with
        its own small archive.  Here, articles are grouped by subject.
        The name of each subdirectory is the same as the subjects of
        all the articles in that directory.  Again, the individual
        articles are named using the same numbers found in the
        "number/" directory.

        For example, if article number/23 has the subject:

            MIME and Z-Mail

        And if number/27 was a followup, with the subject:

            Re: MIME and Z-Mail

        The archiver will clean off the "Re:", and those two articles
        will also be found as:

            subject/MIME and Z-Mail/23
            subject/MIME and Z-Mail/27

        Again, you can also download an entire subject's worth of
        articles at once, as a tar archive.  Just add ".tar",
        ".tar.Z", or ".tar.gz" to the end of any subdirectory name,
        and get that as though it were a file.  The entire contents of
        that directory will be streamed to you as a single tar
        archive.

</pre>

<HR>
<address><a href="mailto:support@z-code.com">support@z-code.com</a></address><p>
<a href="zsupport.html">
<img src="../images/zslacker.gif"></a>
<a href="../zcode.html">
<img src="../images/zcode.gif"></a>
<a href="../../welcome.html">
<img src="../images/corp_small_icon.gif"></a><p>
[<a href="zsupport.html">Z-Support</a>] [<a href="../zcode.html">Z-Code</a>] [<a
 href="../../welcome.html">NCD</a>]
<h6>COPYRIGHT 1994 Network Computing Devices , Inc.</H6>
</BODY>
